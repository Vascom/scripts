#!/bin/bash

SEQ="4 5 6"
NUMBER_LINES=`cat $1 | head -n 1 | cut -d "," -f2`
TEMP_LINE=`cat $1 | head -n $NUMBER_LINES | tail -n +2`

for n in $TEMP_LINE
do
    for k in $SEQ
    do
        STATE=`echo $n | cut -d "," -f$k`
        NAME=`echo $n | cut -d "," -f1`
        BUILD=`expr $k + 10`
        if [ "$STATE" = "-" ]
        then
            REV=`echo $n | cut -d "," -f3`
            ./koji_run $NAME $REV $BUILD quiet
        elif [[ ("$STATE" = '+' || "$STATE" = 'b+') && "$2" = "repo"  ]]
        then
            REPONUM=`expr $k + 3`
            INREPO=`echo $n | cut -d "," -f$REPONUM`
            if [[ "$INREPO" = "-" ]]
            then
                echo "$NAME not in repo $BUILD"
            fi
        fi
    done
done
